language: c

before_install:
    - sudo apt-get -qq update
    - sudo apt-get install -y git debhelper fakeroot
    - sudo apt-get install -y libpcap-dev libselinux1-dev
    - sudo apt-get install -y binutils-mingw-w64-i686 gcc-mingw-w64 mingw-w64-i686-dev mingw-w64-common
    - sudo apt-get install -y autoconf automake dh-autoreconf

after_failure:
    - cat config.log

script:
    - ./autogen.sh
    - git clean -df . && dpkg-buildpackage -b -us -uc
    - git clean -df . && export CC=i686-w64-mingw32-gcc && ./autogen.sh --host=i686-w64-mingw32 --build=$(gcc -dumpmachine)

# automatic coverity scan
env:
	global:
		- secure: "CN5K1QzTszUC/+U9m7cs2JJON/xUHf5umtAGQDrDCkr1o0y4+jbLv6LS5iBoJ3mG5mCeoVHfubg+2kk46+QiwgoRnENw59/aXotAELYZjkYDhi4KpZ/AjJ0sUiC2YlHE6pyC9PO/atMWGqATboP77EwbgYd+JAjblzh3FzKZ8GTavpaHDo8P96UE/YlmYewlHe2iqm36OyXhrOApqqa2hEDYmSXS8HIWhXszm0nwpdeee6ys8pC+ZHxSkPZ0u+N8pf71my25vqRGcpz7VWktv0FMfNvld9+dgw+SZBk9i9YALvJHkEdcBwAmlg9EoT8LsI3GPvuPI1C0sQPq5fT2POUa4DB59IiKbhRoajwFs7g+LiJvuW2VewWWf3K0eacyQ5/G5ATfzuCC83qo1mr3UwVSTwdpPdHumUV6DnR7JPbh1d2ZzzpG9rUpkB7Gg7DiR19w0DRyRq5FvaBmEdRudjBeySXmOE+MwxfBqZUgmNtd2rTaNKWj2XlGCHuyi5rUD2Y0cFaOOdqqwYEIDNEPpdOGoihHfGDFsvAg21h81peW/9p9CBmnXOH+8b/BnSeh0ibP0SXnPZMFUy8RaHBVnNTmOqDSym4uBB+KzJ5a/VGdO4O4SAwHF/PkQfqHQr5TNO4WaZd6mY7JWsXkYRi+4KIglQIIBYhkhBO1Z7L855k="

addons:
	coverity_scan:

	project:
		name: my_github/my_project
		version: 1.0
		description: My Project

	notification_email: matzeton@googlemail.com
	build_command_prepend: autoreconf -i && ./configure
	build_command: make
	branch_pattern: coverity_scan
