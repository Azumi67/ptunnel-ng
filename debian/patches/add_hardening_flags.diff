Description: Add Hardening flags
Forwarded: no
Author: Daniel Echeverry <epsilon77@gmail.com>
Last-Update: 2016-02-16
--- a/Makefile
+++ b/Makefile
@@ -32,7 +32,7 @@ install: ptunnel
 	install ./ptunnel.8 $(mandir)/ptunnel.8
 
 ptunnel: $(PT_OBJS)
-	$(CC) -o $@ $^ $(LDOPTS) `[ -e /usr/include/selinux/selinux.h ] && echo -lselinux`
+	$(CC) $(CFLAGS) $(CPPFLAGS) $(LDFLAGS) -o $@ $^ $(LDOPTS) `[ -e /usr/include/selinux/selinux.h ] && echo -lselinux`
 
 ptunnel.exe: $(WIN32_PT_OBJS)
 	$(CC) -o $@ $^ $(WIN32_LDOPTS)
@@ -44,10 +44,10 @@ clean:
 
 depend: .depend
 .depend:
-	$(CC) $(CFLAGS) -MM *.c > $@
+	$(CC) $(CFLAGS) $(CPPFLAGS) -MM *.c > $@
 
 %.o:%.c
-	$(CC) $(CFLAGS) `[ -e /usr/include/selinux/selinux.h ] && echo -DHAVE_SELINUX` -c -o $@ $<
+	$(CC) $(CFLAGS) $(CPPFLAGS) `[ -e /usr/include/selinux/selinux.h ] && echo -DHAVE_SELINUX` -c -o $@ $<
 
 %.obj:%.c
 	$(WIN32_CC) $(WIN32_CFLAGS) -c -o $@ $<
